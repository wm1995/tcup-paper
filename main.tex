% main.tex
%
% LaTeX template for creating an MNRAS paper
%
% v3.0 released 14 May 2015
% (version numbers match those of mnras.cls)
%
% Copyright (C) Royal Astronomical Society 2015
% Authors:
% Keith T. Smith (Royal Astronomical Society)

% Change log
%
% v3.0 May 2015
%    Renamed to match the new package name
%    Version number matches mnras.cls
%    A few minor tweaks to wording
% v1.0 September 2013
%    Beta testing only - never publicly released
%    First version: a simple (ish) template for creating an MNRAS paper

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic setup. Most papers should leave these options alone.
\documentclass[fleqn,usenatbib]{mnras}

% MNRAS is set in Times font. If you don't have this installed (most LaTeX
% installations will be fine) or prefer the old Computer Modern fonts, comment
% out the following line
\usepackage{newtxtext,newtxmath}
% Depending on your LaTeX fonts installation, you might get better results with one of these:
%\usepackage{mathptmx}
%\usepackage{txfonts}

% Use vector fonts, so it zooms properly in on-screen viewing software
% Don't change these lines unless you know what you are doing
\usepackage[T1]{fontenc}

% Allow "Thomas van Noord" and "Simon de Laguarde" and alike to be sorted by "N" and "L" etc. in the bibliography.
% Write the name in the bibliography as "\VAN{Noord}{Van}{van} Noord, Thomas"
\DeclareRobustCommand{\VAN}[3]{#2}
\let\VANthebibliography\thebibliography
\def\thebibliography{\DeclareRobustCommand{\VAN}[3]{##3}\VANthebibliography}


%%%%% AUTHORS - PLACE YOUR OWN PACKAGES HERE %%%%%

% Only include extra packages if you really need them. Common packages are:
\usepackage{graphicx}	% Including figure files
\usepackage{amsmath}	% Advanced maths commands
% \usepackage{amssymb}	% Extra maths symbols

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%% AUTHORS - PLACE YOUR OWN COMMANDS HERE %%%%%

% Please keep new commands to a minimum, and use \newcommand not \def to avoid
% overwriting existing commands. Example:
%\newcommand{\pcm}{\,cm$^{-2}$}	% per cm-squared

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%% TITLE PAGE %%%%%%%%%%%%%%%%%%%

% Title of the paper, and the short title which is used in the headers.
% Keep the title short and informative.
\title[Robust regression for astronomy]{Robust regression with measurement errors in an astronomical context}

% The list of authors, and the short list which is used in the headers.
% If you need two or more lines of authors, add an extra line using \newauthor
\author[W. Martin et al.]{
William Martin$^{1}$\thanks{E-mail: w.martin19@imperial.ac.uk}
and Daniel Mortlock$^{1,2,3}$
\\
% List of institutions
$^{1}$Department of Physics, Imperial College London, Blackett Laboratory, Prince Consort Road, London SW7 2AZ, UK\\
$^{2}$Department of Mathematics, Imperial College London, London, SW7 2AZ, UK\\
$^{3}$Department of Astronomy, The Oskar Klein Centre, Stockholm University, Albanova, SE-10691 Stockholm, Sweden
}

% These dates will be filled out by the publisher
\date{Accepted XXX. Received YYY; in original form ZZZ}

% Enter the current year, for the copyright statements etc.
\pubyear{2023}

% Don't change these lines
\begin{document}
\label{firstpage}
\pagerange{\pageref{firstpage}--\pageref{lastpage}}
\maketitle

% Abstract of the paper
\begin{abstract}
A Bayesian hierarchical model for robust linear regression in the presence of measurement error is described.
The performance of the model is assessed on both simulated and real datasets.
The code is made available for others to use.
\end{abstract}

% Select between one and six entries from the list of approved keywords.
% Don't make up new ones.
\begin{keywords}
methods: statistical -- methods: data analysis -- software: data analysis
\end{keywords}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% BODY OF PAPER %%%%%%%%%%%%%%%%%%

\section{Introduction}
\label{sec:intro}

{\color{red}

(Each point is ~1 paragraph.)

Regression generally important in astronomy (e.g., M-$\sigma$)

Astronomy data well characterised errors, but with some outliers

Previously sigma-clipping or outlier removal; better to model the full measurement process

Review of previous methods (e.g., Kelly)

Characterise as an example of robust inference (i.e., don't need to know the actual generating distribution); mention some existing uses of this (e.g., Feeney, Park)

Then say presenting practical methodology and implementation here.
}

There are multiple approaches to the problem of linear regression in astronomy
where all variables are measured with error.  \citet{Kelly:2007} illustrates
that ad-hoc estimators such as \textsc{fitexy} \citep{Press:1992, Tremaine:2002}
and \textsc{bces} \citep{Akritas:1996} suffer from biases and can underestimate
intrinsic scatter. As an alternative, Kelly presents a Bayesian hierarchical
model for linear regression with measurement errors as an alternative. However,
the model is designed to be sampled using Gibbs sampling, which limits the
choice of distributions for variables within the model and the number of
parameters that can be fit simultaneously. As a result of the former, the model
assumes random variables are normally distributed throughout; however, inference
that relies on normal distributions can be unduly affected by outliers (see
\citet{Berger:1994} for a review of robust Bayesian inference).  One possible
alternative is to use Student's $t$-distributions, which have heavier tails and
are, therefore, less affected by the presence of outliers \citep{Berger:1994};
Student's $t$-distributions have seen use in astronomical
\citep[][e.g.]{Park:2017} and cosmological \citep[][e.g.]{Feeney:2018}
inference.

Bayesian hierarchical models (BHMs) are a natural way to deal with datasets with
measurement errors, selection effects, interlinked parameters, censored data,
and many other effects common to astronomical problems. BHMs have seen
increasing use in astrophysics over the past 30 years, from the
distance-redshift relation in cosmology \citep[e.g.][]{Feeney:2018,
Avelino:2019} and photometric redshift estimation \citep[e.g.][]{Leistedt:2016}
to exoplanet characterisation \citep[e.g.][]{Sestovic:2018} and population-level
inference \citep[e.g.][]{Kelly:2009} --- see \citet{Feigelson:2021} for a recent
review of statistical methods in astrophysics, including further examples of
BHMs.

\citet{Kelly:2007} formulated a Bayesian linear regression model under the
assumption of Gaussianity and compared it with other common regression methods
in astronomy, including ordinary least squares, \textsc{bces}
\citep{Akritas:1996}, and \textsc{fitexy} \citep{Press:1992, Tremaine:2002}.
\citeauthor{Kelly:2007} found that the Bayesian approach had several advantages
over the other methods considered: no bootstrapping was required to obtain
uncertainties on parameters; the Bayesian approach was easily extensible to
truncated or censored data; and other methods would sometimes severely
underestimate intrinsic scatter in the data. This formulation of Bayesian
regression, sometimes known as \textsc{linmix\_err}, is now commonly used in
astronomy \citep[e.g.][]{McConnell:2013, Bentz:2013, Andrews:2013}.

When we have a dataset that has a large number of outliers, our inference of
certain parameters can be drawn off by the presence of those outliers. Robust
inference refers to a body of techniques to fit in an outlier-resistant way so
that we can recover the parameters of interest while not being unduly affected
by the outliers.  For example, ordinary least squares regression is based on the
assumption that datapoints are normally distributed about a true regression
line; however, normal distributions have exponential tails, which means that
this approach is often heavily affected by the presence of outliers (see Section
\ref{sec:results} for an exploration of this effect). An alternative approach is
to use heavier-tailed distributions.  Examples of this include least absolute
deviation regression, where the data is assumed to be Laplace-distributed about
the regression line.  Another distribution that can be used is Student's
$t$-distribution \citep[e.g.][]{Berger:1994, Gelman:2013}, which also has
heavier tails than a normal distribution --- see Section \ref{sec:results} for a
comparison of regression using normal distributions and $t$-distributions.

There are several approaches to robust inference in a Bayesian context
--- see \citet{Berger:1994} for a review. Examples of applications of robust
inference in astronomy include \citet{Park:2017, Feeney:2018}.

From the review of previous methods, we can identify properties that we would
like to see in our regression model:

\begin{itemize}
	\item A Bayesian hierarchical model -- we favour a hierarchical approach
	because it naturally encodes the hierarchical structure of astronomical
	regression problems (i.e.\ objects are drawn from a high-level population;
	the objects intrinsically obey some relationship; the objects are measured
	with error and only the measured values are known). We favour a Bayesian
	approach because it gives posterior distributions encoding our degree of
	belief of the values of parameters, quantifying our uncertainty in their
	values.

	\item A robust model -- we desire a model that is robust to both outliers
	(i.e.\ data points that, whether intrinsically or by virtue of measurement
	errors, do not lie on our regression relation) and model misspecification
	(i.e.\ where the underlying distribution of data does not match up with the
	distribution assumed for modelling).

	\item A general method -- we seek a model that does not require case-by-case
	optimisation for application to different regression problems (e.g.\ no
	manual outlier identification and removal, no need to rescale prior
	distributions for different problems, etc.)
\end{itemize}

\section{Formalism}
\label{sec:formalism}

\subsection{Regression model}
\label{sec:formalism.model}

\subsection{Sampling distribution}
\label{sec:formalism.sampling}

\subsubsection{Priors on $t$-distribution parameters}
\label{sec:formalism.sampling.prior}

\subsection{Asymptotic normality}
\label{sec:formalism.asymptotic}

\subsection{Implementation}
\label{sec:formalism.implementation}

% Normally the next section describes the techniques the authors used.
% It is frequently split into subsections, such as Section~\ref{sec:maths} below.

% \subsection{Maths}
% \label{sec:maths} % used for referring to this section from elsewhere

% Simple mathematics can be inserted into the flow of the text e.g. $2\times3=6$
% or $v=220$\,km\,s$^{-1}$, but more complicated expressions should be entered
% as a numbered equation:

% \begin{equation}
%     x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}.
% 	\label{eq:quadratic}
% \end{equation}

% Refer back to them as e.g. equation~(\ref{eq:quadratic}).

% \subsection{Figures and tables}

% Figures and tables should be placed at logical positions in the text. Don't
% worry about the exact layout, which will be handled by the publishers.

% Figures are referred to as e.g. Fig.~\ref{fig:example_figure}, and tables as
% e.g. Table~\ref{tab:example_table}.

\section{Results on simulated datasets}
\label{sec:results}

Simulate data-sets with different numbers of outliers (just normally distributed with no outliers; normally distributed with a chosen fraction of manual outliers; t distributed with a chosen shape parameter; drawn from some other heavy-tailed distribution such as a normal mixture or exponential/Laplace; asymmetric, such a log-normal).  Basic presentation of results will be similar for each case: showing the simulated data with posterior draws of fitted lines/curves (as in your presentation plots) and corner plots

\section{Demonstration on real-world data}
\label{sec:real-world}

A simple demonstration on real data (Park is a possibility; another is an M-sigma analysis; possibly the data from the Kelly paper).  Suggest trying this on the paper used by Kelly as can directly compare.

% Example figure
\begin{figure}
	% To include a figure from a file named example.*
	% Allowable file formats are eps or ps if compiling using latex
	% or pdf, png, jpg if compiling using pdflatex
	%\includegraphics[width=\columnwidth]{example}
    Column width is \the\columnwidth.
    Text width is \the\textwidth.
    \caption{This is an example figure. Captions appear below each figure.
	Give enough detail for the reader to understand what they're looking at,
	but leave detailed discussion to the main body of the text.}
    \label{fig:example_figure}
\end{figure}

\begin{figure*}
	% To include a figure from a file named example.*
	% Allowable file formats are eps or ps if compiling using latex
	% or pdf, png, jpg if compiling using pdflatex
	%\includegraphics[width=\columnwidth]{example}
    \the\textwidth
    \caption{This is an example figure. Captions appear below each figure.
	Give enough detail for the reader to understand what they're looking at,
	but leave detailed discussion to the main body of the text.}
    \label{fig:example_widefigure}
\end{figure*}

% Example table
\begin{table}
	\centering
	\caption{This is an example table. Captions appear above each table.
	Remember to define the quantities, symbols and units used.}
	\label{tab:example_table}
	\begin{tabular}{lccr} % four columns, alignment for each
		\hline
		A & B & C & D\\
		\hline
		1 & 2 & 3 & 4\\
		2 & 4 & 6 & 8\\
		3 & 5 & 7 & 9\\
		\hline
	\end{tabular}
\end{table}


\section{Conclusions}

Summarise the take-home point that the method is a form of robust inference; works on all sorts of outliers; then lead on to use in Paper 2 on the mass ladder.

\section*{Acknowledgements}

The Acknowledgements section is not numbered. Here you can thank helpful
colleagues, acknowledge funding agencies, telescopes and facilities used etc.
Try to keep it short.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data Availability}


The inclusion of a Data Availability Statement is a requirement for articles published in MNRAS. Data Availability Statements provide a standardised format for readers to understand the availability of data underlying the research results described in the article. The statement may refer to original data generated in the course of the study or to third-party data analysed in the article. The statement should describe and provide means of access, where possible, by linking to the data or providing the required accession numbers for the relevant databases or DOIs.




%%%%%%%%%%%%%%%%%%%% REFERENCES %%%%%%%%%%%%%%%%%%

% The best way to enter references is to use BibTeX:

\bibliographystyle{mnras}
\bibliography{references}


% Alternatively you could enter them by hand, like this:
% This method is tedious and prone to error if you have lots of references
%\begin{thebibliography}{99}
%\bibitem[\protect\citeauthoryear{Author}{2012}]{Author2012}
%Author A.~N., 2013, Journal of Improbable Astronomy, 1, 1
%\bibitem[\protect\citeauthoryear{Others}{2013}]{Others2013}
%Others S., 2012, Journal of Interesting Stuff, 17, 198
%\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% APPENDICES %%%%%%%%%%%%%%%%%%%%%

\appendix

\section{Some extra material}

If you want to present additional material which would interrupt the flow of the main paper,
it can be placed in an Appendix which appears after the list of references.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Don't change these lines
\bsp	% typesetting comment
\label{lastpage}
\end{document}

% End of mnras_template.tex
